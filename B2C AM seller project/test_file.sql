
create table p_nishant_local_t.yoy_change as
SELECT 
RETAIL_YEAR, RETAIL_WEEK,
SLR_ID,
(a.T1W_GMV - b.T1W_GMV)/b.T1W_GMV as T1W_GMV_yoy,
(a.T1W_GMV_LC - b.T1W_GMV_LC)/b.T1W_GMV_LC T1W_GMV_LC_yoy,
(a.T1W_gsp_GMV - b.T1W_gsp_GMV)/b.T1W_gsp_GMV  T1W_gsp_GMV_yoy,
(a.T1W_SI - b.T1W_SI)/b.T1W_SI T1W_SI_yoy,
(a.T1W_CBT_GMV - b.T1W_CBT_GMV)/b.T1W_CBT_GMV T1W_CBT_GMV_yoy,
(a.T1W_CBT_SI - b.T1W_CBT_SI)/b.T1W_CBT_SI T1W_CBT_SI_yoy,
(a.T1W_CBT_ASP - b.T1W_CBT_ASP)/b.T1W_CBT_ASP T1W_CBT_ASP_yoy,
(a.T1W_CBT_PERC - b.T1W_CBT_PERC)/b.T1W_CBT_PERC T1W_CBT_PERC_yoy,
(a.T1W_new_item_GMV - b.T1W_new_item_GMV)/b.T1W_new_item_GMV T1W_new_item_GMV_yoy,
(a.T1W_New_other_item_GMV - b.T1W_New_other_item_GMV)/b.T1W_New_other_item_GMV T1W_New_other_item_GMV_yoy,
(a.T1W_New_with_defects_item_GMV - b.T1W_New_with_defects_item_GMV)/b.T1W_New_with_defects_item_GMV T1W_New_with_defects_item_GMV_yoy,
(a.T1W_Certified_Refurbished_item_GMV - b.T1W_Certified_Refurbished_item_GMV)/b.T1W_Certified_Refurbished_item_GMV T1W_Certified_Refurbished_item_GMV_yoy,
(a.T1W_Excellent_Refurbished_GMV_ - b.T1W_Excellent_Refurbished_GMV_)/b.T1W_Excellent_Refurbished_GMV_ T1W_Excellent_Refurbished_GMV__yoy,
(a.T1W_VGood_Refurbished_item_GMV - b.T1W_VGood_Refurbished_item_GMV)/b.T1W_VGood_Refurbished_item_GMV T1W_VGood_Refurbished_item_GMV_yoy,
(a.T1W_Seller_refurbished_item_GMV - b.T1W_Seller_refurbished_item_GMV)/b.T1W_Seller_refurbished_item_GMV T1W_Seller_refurbished_item_GMV_yoy,
(a.T1W_Like_new_item_GMV - b.T1W_Like_new_item_GMV)/b.T1W_Like_new_item_GMV T1W_Like_new_item_GMV_yoy,
(a.T1W_used_item_GMV - b.T1W_used_item_GMV)/b.T1W_used_item_GMV T1W_used_item_GMV_yoy,

(a.T1W_vgood_item_GMV - b.T1W_vgood_item_GMV)/b.T1W_vgood_item_GMV T1W_vgood_item_GMV_yoy,
(a.T1W_good_item_GMV - b.T1W_good_item_GMV)/b.T1W_good_item_GMV T1W_good_item_GMV_yoy,
(a.T1W_acceptable_item_GMV - b.T1W_acceptable_item_GMV)/b.T1W_acceptable_item_GMV T1W_acceptable_item_GMV_yoy,
(a.T1W_For_parts_or_not_working_item_GMV - b.T1W_For_parts_or_not_working_item_GMV)/b.T1W_For_parts_or_not_working_item_GMV T1W_For_parts_or_not_working_item_GMV_yoy,
(a. T52W_new_item_GMV - b. T52W_new_item_GMV)/b. T52W_new_item_GMV  T52W_new_item_GMV_yoy,
(a. T52W_New_other_item_GMV - b. T52W_New_other_item_GMV)/b. T52W_New_other_item_GMV  T52W_New_other_item_GMV_yoy,
(a. T52W_New_with_defects_item_GMV - b. T52W_New_with_defects_item_GMV)/b. T52W_New_with_defects_item_GMV  T52W_New_with_defects_item_GMV_yoy,
(a.T52W_Certified_Refurbished_item_GMV - b.T52W_Certified_Refurbished_item_GMV)/b.T52W_Certified_Refurbished_item_GMV T52W_Certified_Refurbished_item_GMV_yoy,
(a.T52W_Excellent_Refurbished_GMV - b.T52W_Excellent_Refurbished_GMV)/b.T52W_Excellent_Refurbished_GMV T52W_Excellent_Refurbished_GMV_yoy,
(a.T52W_VGood_Refurbished_item_GMV - b.T52W_VGood_Refurbished_item_GMV)/b.T52W_VGood_Refurbished_item_GMV T52W_VGood_Refurbished_item_GMV_yoy,
(a.T52W_Good_Refurbished_item_GMV - b.T52W_Good_Refurbished_item_GMV)/b.T52W_Good_Refurbished_item_GMV T52W_Good_Refurbished_item_GMV_yoy,
(a.T52W_Seller_refurbished_item_GMV - b.T52W_Seller_refurbished_item_GMV)/b.T52W_Seller_refurbished_item_GMV T52W_Seller_refurbished_item_GMV_yoy,
(a.T52W_Like_new_item_GMV - b.T52W_Like_new_item_GMV)/b.T52W_Like_new_item_GMV T52W_Like_new_item_GMV_yoy,
(a.T52W_used_item_GMV - b.T52W_used_item_GMV)/b.T52W_used_item_GMV T52W_used_item_GMV_yoy,
(a.T52W_vgood_item_GMV - b.T52W_vgood_item_GMV)/b.T52W_vgood_item_GMV T52W_vgood_item_GMV_yoy,
(a.T52W_good_item_GMV - b.T52W_good_item_GMV)/b.T52W_good_item_GMV T52W_good_item_GMV_yoy,
(a.T52W_acceptable_item_GMV - b.T52W_acceptable_item_GMV)/b.T52W_acceptable_item_GMV T52W_acceptable_item_GMV_yoy,
(a.T52W_For_parts_or_not_working_item_GMV - b.T52W_For_parts_or_not_working_item_GMV)/b.T52W_For_parts_or_not_working_item_GMV T52W_For_parts_or_not_working_item_GMV_yoy,
(a.T52W_GMV - b.T52W_GMV)/b.T52W_GMV T52W_GMV_yoy,
(a.T52W_GMV_LC - b.T52W_GMV_LC)/b.T52W_GMV_LC T52W_GMV_LC_yoy,
(a.T52W_gsp_GMV - b.T52W_gsp_GMV)/b.T52W_gsp_GMV T52W_gsp_GMV_yoy,
(a.T52W_SI - b.T52W_SI)/b.T52W_SI T52W_SI_yoy,
(a.T52W_ASP - b.T52W_ASP)/b.T52W_ASP T52W_ASP_yoy,
(a.T52W_CBT_GMV - b.T52W_CBT_GMV)/b.T52W_CBT_GMV T52W_CBT_GMV_yoy,
(a.T52W_CBT_SI - b.T52W_CBT_SI)/b.T52W_CBT_SI T52W_CBT_SI_yoy,
(a.T52W_CBT_ASP - b.T52W_CBT_ASP)/b.T52W_CBT_ASP T52W_CBT_ASP_yoy,
(a.T52W_CBT_PERC - b.T52W_CBT_PERC)/b.T52W_CBT_PERC T52W_CBT_PERC_yoy,
(a.T13W_GMV - b.T13W_GMV)/b.T13W_GMV T13W_GMV_yoy,
(a.T13W_SI - b.T13W_SI)/b.T13W_SI T13W_SI_yoy,
(a.T13W_ASP - b.T13W_ASP)/b.T13W_ASP T13W_ASP_yoy,
(a.T13W_CBT_GMV - b.T13W_CBT_GMV)/b.T13W_CBT_GMV T13W_CBT_GMV_yoy,
(a.T13W_CBT_SI - b.T13W_CBT_SI)/b.T13W_CBT_SI T13W_CBT_SI_yoy,
(a.T13W_CBT_ASP - b.T13W_CBT_ASP)/b.T13W_CBT_ASP T13W_CBT_ASP_yoy,
(a.T1W_LL - b.T1W_LL)/b.T1W_LL T1W_LL_yoy,
(a.T1W_escal_SNAD_count - b.T1W_escal_SNAD_count)/b.T1W_escal_SNAD_count T1W_escal_SNAD_count_yoy,
(a.T1W_non_escal_SNAD_count - b.T1W_non_escal_SNAD_count)/b.T1W_non_escal_SNAD_count T1W_non_escal_SNAD_count_yoy,
(a.T1W_STOCKOUT_count - b.T1W_STOCKOUT_count)/b.T1W_STOCKOUT_count T1W_STOCKOUT_count_yoy,
(a.T1W_escal_INR_count - b.T1W_escal_INR_count)/b.T1W_escal_INR_count T1W_escal_INR_count_yoy,
(a.T1W_non_escal_INR_count - b.T1W_non_escal_INR_count)/b.T1W_non_escal_INR_count T1W_non_escal_INR_count_yoy,
(a.T1W_low_IAD_DSR_count - b.T1W_low_IAD_DSR_count)/b.T1W_low_IAD_DSR_count T1W_low_IAD_DSR_count_yoy,
(a.T1W_NN_feedback_count - b.T1W_NN_feedback_count)/b.T1W_NN_feedback_count T1W_NN_feedback_count_yoy,
(a.T1W_Non_escal_SNAD_MSG_count - b.T1W_Non_escal_SNAD_MSG_count)/b.T1W_Non_escal_SNAD_MSG_count T1W_Non_escal_SNAD_MSG_count_yoy,
(a.T1W_Non_escal_INR_MSG_count - b.T1W_Non_escal_INR_MSG_count)/b.T1W_Non_escal_INR_MSG_count T1W_Non_escal_INR_MSG_count_yoy,
(a.T52W_escal_SNAD_count - b.T52W_escal_SNAD_count)/b.T52W_escal_SNAD_count T52W_escal_SNAD_count_yoy,
(a.T52W_non_escal_SNAD_count - b.T52W_non_escal_SNAD_count)/b.T52W_non_escal_SNAD_count T52W_non_escal_SNAD_count_yoy,
(a.T52W_STOCKOUT_count - b.T52W_STOCKOUT_count)/b.T52W_STOCKOUT_count T52W_STOCKOUT_count_yoy,
(a.T52W_escal_INR_count - b.T52W_escal_INR_count)/b.T52W_escal_INR_count T52W_escal_INR_count_yoy,
(a.T52W_non_escal_INR_count - b.T52W_non_escal_INR_count)/b.T52W_non_escal_INR_count T52W_non_escal_INR_count_yoy,
(a.T52W_low_IAD_DSR_count - b.T52W_low_IAD_DSR_count)/b.T52W_low_IAD_DSR_count T52W_low_IAD_DSR_count_yoy,
(a.T52W_NN_feedback_count - b.T52W_NN_feedback_count)/b.T52W_NN_feedback_count T52W_NN_feedback_count_yoy,
(a.T52W_Non_escal_SNAD_MSG_count - b.T52W_Non_escal_SNAD_MSG_count)/b.T52W_Non_escal_SNAD_MSG_count T52W_Non_escal_SNAD_MSG_count_yoy,
(a.T52W_Non_escal_INR_MSG_count - b.T52W_Non_escal_INR_MSG_count)/b.T52W_Non_escal_INR_MSG_count T52W_Non_escal_INR_MSG_count_yoy,
(a.STARTER_STORE_COUNT - b.STARTER_STORE_COUNT)/b.STARTER_STORE_COUNT STARTER_STORE_COUNT_yoy,
(a.BASIC_STORE_COUNT - b.BASIC_STORE_COUNT)/b.BASIC_STORE_COUNT BASIC_STORE_COUNT_yoy,
(a.FEATURE_STORE_COUNT - b.FEATURE_STORE_COUNT)/b.FEATURE_STORE_COUNT FEATURE_STORE_COUNT_yoy,
(a.ANCHOR_STORE_COUNT - b.ANCHOR_STORE_COUNT)/b.ANCHOR_STORE_COUNT ANCHOR_STORE_COUNT_yoy,
(a.ENTERPRISE_STORE_COUNT - b.ENTERPRISE_STORE_COUNT)/b.ENTERPRISE_STORE_COUNT ENTERPRISE_STORE_COUNT_yoy,
(a.T1W_SELLERH_CNT - b.T1W_SELLERH_CNT)/b.T1W_SELLERH_CNT T1W_SELLERH_CNT_yoy,
(a.T1W_NATIVE_CNT - b.T1W_NATIVE_CNT)/b.T1W_NATIVE_CNT T1W_NATIVE_CNT_yoy,
(a.T52W_SELLERH_CNT - b.T52W_SELLERH_CNT)/b.T52W_SELLERH_CNT T52W_SELLERH_CNT_yoy,
(a.T52W_NATIVE_CNT - b.T52W_NATIVE_CNT)/b.T52W_NATIVE_CNT T52W_NATIVE_CNT_yoy,
(a.t1w_total_spend_lc - b.t1w_total_spend_lc)/b.t1w_total_spend_lc t1w_total_spend_lc_yoy,
(a.t1w_ebay_spend_lc - b.t1w_ebay_spend_lc)/b.t1w_ebay_spend_lc t1w_ebay_spend_lc_yoy,

(a.t1w_seller_coupon_spend_lc - b.t1w_seller_coupon_spend_lc)/b.t1w_seller_coupon_spend_lc t1w_seller_coupon_spend_lc_yoy,
(a.t52w_total_spend_lc - b.t52w_total_spend_lc)/b.t52w_total_spend_lc t52w_total_spend_lc_yoy,
(a.t52w_ebay_spend_lc - b.t52w_ebay_spend_lc)/b.t52w_ebay_spend_lc t52w_ebay_spend_lc_yoy,
(a.t52w_seller_coupon_spend_lc - b.t52w_seller_coupon_spend_lc)/b.t52w_seller_coupon_spend_lc t52w_seller_coupon_spend_lc_yoy,
(a.t1w_gross_fvf_lc - b.t1w_gross_fvf_lc)/b.t1w_gross_fvf_lc t1w_gross_fvf_lc_yoy,
(a.t1w_gross_fvf - b.t1w_gross_fvf)/b.t1w_gross_fvf t1w_gross_fvf_yoy,
(a.t1w_net_fvf_lc - b.t1w_net_fvf_lc)/b.t1w_net_fvf_lc t1w_net_fvf_lc_yoy,
(a.t1w_net_fvf - b.t1w_net_fvf)/b.t1w_net_fvf t1w_net_fvf_yoy,
(a.t13w_gross_fvf_lc - b.t13w_gross_fvf_lc)/b.t13w_gross_fvf_lc t13w_gross_fvf_lc_yoy,
(a.t13w_gross_fvf - b.t13w_gross_fvf)/b.t13w_gross_fvf t13w_gross_fvf_yoy,
(a.t13w_net_fvf_lc - b.t13w_net_fvf_lc)/b.t13w_net_fvf_lc t13w_net_fvf_lc_yoy,
(a.t13w_net_fvf - b.t13w_net_fvf)/b.t13w_net_fvf t13w_net_fvf_yoy,
(a.T13W_FVF_TAKE_RATE - b.T13W_FVF_TAKE_RATE)/b.T13W_FVF_TAKE_RATE T13W_FVF_TAKE_RATE_yoy,
(a.t52w_gross_fvf_lc - b.t52w_gross_fvf_lc)/b.t52w_gross_fvf_lc t52w_gross_fvf_lc_yoy,
(a.t52w_gross_fvf - b.t52w_gross_fvf)/b.t52w_gross_fvf t52w_gross_fvf_yoy,
(a.t52w_net_fvf_lc - b.t52w_net_fvf_lc)/b.t52w_net_fvf_lc t52w_net_fvf_lc_yoy,
(a.t52w_net_fvf - b.t52w_net_fvf)/b.t52w_net_fvf t52w_net_fvf_yoy,
(a.T52_fvf_TAKE_RATE - b.T52_fvf_TAKE_RATE)/b.T52_fvf_TAKE_RATE T52_fvf_TAKE_RATE_yoy,
(a.T13W_Insertion_Fee - b.T13W_Insertion_Fee)/b.T13W_Insertion_Fee T13W_Insertion_Fee_yoy,
(a.T13W_Subscription_Fee - b.T13W_Subscription_Fee)/b.T13W_Subscription_Fee T13W_Subscription_Fee_yoy,
(a.T13W_PL_Fee - b.T13W_PL_Fee)/b.T13W_PL_Fee T13W_PL_Fee_yoy,
(a.T52W_Variable_FVF - b.T52W_Variable_FVF)/b.T52W_Variable_FVF T52W_Variable_FVF_yoy,
(a.T52W_Fixed_FVF - b.T52W_Fixed_FVF)/b.T52W_Fixed_FVF T52W_Fixed_FVF_yoy,
(a.T52W_Insertion_Fee - b.T52W_Insertion_Fee)/b.T52W_Insertion_Fee T52W_Insertion_Fee_yoy,
(a.T52W_Subscription_Fee - b.T52W_Subscription_Fee)/b.T52W_Subscription_Fee T52W_Subscription_Fee_yoy,
(a.T52W_PL_Fee - b.T52W_PL_Fee)/b.T52W_PL_Fee T52W_PL_Fee_yoy,
(a.T1W_AVG_TITLE_LENGTH - b.T1W_AVG_TITLE_LENGTH)/b.T1W_AVG_TITLE_LENGTH T1W_AVG_TITLE_LENGTH_yoy,
(a.T1W_AVG_SUBTITLE_LENGTH - b.T1W_AVG_SUBTITLE_LENGTH)/b.T1W_AVG_SUBTITLE_LENGTH T1W_AVG_SUBTITLE_LENGTH_yoy,
(a.T1W_AVG_PHOTO_COUNT - b.T1W_AVG_PHOTO_COUNT)/b.T1W_AVG_PHOTO_COUNT T1W_AVG_PHOTO_COUNT_yoy,
(a.T1W_OUT_M2M_CNT - b.T1W_OUT_M2M_CNT)/b.T1W_OUT_M2M_CNT T1W_OUT_M2M_CNT_yoy,
(a.T52W_OUT_M2M_CNT - b.T52W_OUT_M2M_CNT)/b.T52W_OUT_M2M_CNT T52W_OUT_M2M_CNT_yoy,
(a.T1W_INB_M2M_CNT - b.T1W_INB_M2M_CNT)/b.T1W_INB_M2M_CNT T1W_INB_M2M_CNT_yoy,
(a.T52W_INB_M2M_CNT - b.T52W_INB_M2M_CNT)/b.T52W_INB_M2M_CNT T52W_INB_M2M_CNT_yoy,
(a.T1W_PL_net_revenue_penetration_percnt - b.T1W_PL_net_revenue_penetration_percnt)/b.T1W_PL_net_revenue_penetration_percnt T1W_PL_net_revenue_penetration_percnt_yoy,
(a.T1W_PLS_enabled_GMV_penetration_percnt - b.T1W_PLS_enabled_GMV_penetration_percnt)/b.T1W_PLS_enabled_GMV_penetration_percnt T1W_PLS_enabled_GMV_penetration_percnt_yoy,
(a.T52W_PL_net_revenue_penetration_percnt - b.T52W_PL_net_revenue_penetration_percnt)/b.T52W_PL_net_revenue_penetration_percnt T52W_PL_net_revenue_penetration_percnt_yoy,
(a.T52W_PLS_enabled_GMV_penetration_percnt - b.T52W_PLS_enabled_GMV_penetration_percnt)/b.T52W_PLS_enabled_GMV_penetration_percnt T52W_PLS_enabled_GMV_penetration_percnt_yoy,
(a.T1W_sfa_si - b.T1W_sfa_si)/b.T1W_sfa_si T1W_sfa_si_yoy,

(a.T1W_pls_ad_fee - b.T1W_pls_ad_fee)/b.T1W_pls_ad_fee T1W_pls_ad_fee_yoy,
(a.T1W_pla_ad_fee - b.T1W_pla_ad_fee)/b.T1W_pla_ad_fee T1W_pla_ad_fee_yoy,
(a.T1W_sfa_ad_fee - b.T1W_sfa_ad_fee)/b.T1W_sfa_ad_fee T1W_sfa_ad_fee_yoy,

(a.T1W_total_ad_fee - b.T1W_total_ad_fee)/b.T1W_total_ad_fee T1W_total_ad_fee_yoy,
(a.T1W_pls_ad_fee_LC - b.T1W_pls_ad_fee_LC)/b.T1W_pls_ad_fee_LC T1W_pls_ad_fee_LC_yoy,
(a.T1W_pla_ad_fee_LC - b.T1W_pla_ad_fee_LC)/b.T1W_pla_ad_fee_LC T1W_GMV_LC_yoy,
(a.T1W_sfa_ad_fee_LC - b.T1W_sfa_ad_fee_LC)/b.T1W_sfa_ad_fee_LC T1W_sfa_ad_fee_LC_yoy,
(a.T1W_total_ad_fee_LC - b.T1W_total_ad_fee_LC)/b.T1W_total_ad_fee_LC T1W_total_ad_fee_LC_yoy,
(a.T52W_sfa_si_yoy - b.T52W_sfa_si_yoy)/b.T52W_sfa_si_yoy T52W_sfa_si_yoy_yoy,
(a.T52W_pls_ad_fee - b.T52W_pls_ad_fee)/b.T52W_pls_ad_fee T52W_pls_ad_fee_yoy,
(a.T52W_pla_ad_fee - b.T52W_pla_ad_fee)/b.T52W_pla_ad_fee T52W_pla_ad_fee_yoy,
(a.T52W_sfa_ad_fee - b.T52W_sfa_ad_fee)/b.T52W_sfa_ad_fee T52W_sfa_ad_fee_yoy,
(a.T52W_total_ad_fee - b.T52W_total_ad_fee)/b.T52W_total_ad_fee T52W_total_ad_fee_yoy,
(a.T52W_pls_ad_fee_LC - b.T52W_pls_ad_fee_LC)/b.T52W_pls_ad_fee_LC T52W_pls_ad_fee_LC_yoy,
(a.T52W_pla_ad_fee_LC - b.T52W_pla_ad_fee_LC)/b.T52W_pla_ad_fee_LC T52W_pla_ad_fee_LC_yoy,
(a.T52W_sfa_ad_fee_LC - b.T52W_sfa_ad_fee_LC)/b.T52W_sfa_ad_fee_LC T52W_sfa_ad_fee_LC_yoy,
(a.T52W_total_ad_fee_LC - b.T52W_total_ad_fee_LC)/b.T52W_total_ad_fee_LC T52W_total_ad_fee_LC_yoy,
(a.T1W_PLS_NET_REV - b.T1W_PLS_NET_REV)/b.T1W_PLS_NET_REV T1W_PLS_NET_REV_yoy,
(a.T1W_PLS_GROSS_REV - b.T1W_PLS_GROSS_REV)/b.T1W_PLS_GROSS_REV T1W_PLS_GROSS_REV_yoy,
(a.T1W_PLA_NET_REV - b.T1W_PLA_NET_REV)/b.T1W_PLA_NET_REV T1W_PLA_NET_REV_yoy,
(a.T1W_PLA_GROSS_REV - b.T1W_PLA_GROSS_REV)/b.T1W_PLA_GROSS_REV T1W_PLA_GROSS_REV_yoy,
(a.T1W_PLS_GMV - b.T1W_PLS_GMV)/b.T1W_PLS_GMV T1W_PLS_GMV_yoy,
(a.T1W_PLS_SI - b.T1W_PLS_SI)/b.T1W_PLS_SI T1W_PLS_SI_yoy,
(a.T1W_PLA_GMV - b.T1W_PLA_GMV)/b.T1W_PLA_GMV T1W_PLA_GMV_yoy,
(a.T1W_PLA_SI - b.T1W_PLA_SI)/b.T1W_PLA_SI T1W_PLA_SI_yoy,
(a.T1W_PL_REV - b.T1W_PL_REV)/b.T1W_PL_REV T1W_PL_REV_yoy,
(a.T1W_PLS_Live_Listings - b.T1W_PLS_Live_Listings)/b.T1W_PLS_Live_Listings T1W_PLS_Live_Listings_yoy,
(a.T1W_PLA_Live_listings - b.T1W_PLA_Live_listings)/b.T1W_PLA_Live_listings T1W_PLA_Live_listings_yoy,
(a.T1W_pls_sold_adrate - b.T1W_pls_sold_adrate)/b.T1W_pls_sold_adrate T1W_pls_sold_adrate_yoy,
(a.T52W_PLS_NET_REV - b.T52W_PLS_NET_REV)/b.T52W_PLS_NET_REV T52W_PLS_NET_REV_yoy,
(a.T52W_PLS_GROSS_REV - b.T52W_PLS_GROSS_REV)/b.T52W_PLS_GROSS_REV T52W_PLS_GROSS_REV_yoy,
(a.T52W_PLA_NET_REV - b.T52W_PLA_NET_REV)/b.T52W_PLA_NET_REV T52W_PLA_NET_REV_yoy,
(a.T52W_PLA_GROSS_REV - b.T52W_PLA_GROSS_REV)/b.T52W_PLA_GROSS_REV T52W_PLA_GROSS_REV_yoy,
(a.T52W_PLS_GMV - b.T52W_PLS_GMV)/b.T52W_PLS_GMV T52W_PLS_GMV_yoy,
(a.T52W_PLS_SI - b.T52W_PLS_SI)/b.T52W_PLS_SI T52W_PLS_SI_yoy,
(a.T52W_PLA_GMV - b.T52W_PLA_GMV)/b.T52W_PLA_GMV T52W_PLA_GMV_yoy,
(a.T52W_PLA_SI - b.T52W_PLA_SI)/b.T52W_PLA_SI T52W_PLA_SI_yoy,
(a.T52W_PL_REV - b.T52W_PL_REV)/b.T52W_PL_REV T52W_PL_REV_yoy,
(a.T52W_PL_GMV - b.T52W_PL_GMV)/b.T52W_PL_GMV T52W_PL_GMV_yoy,

(a.T52W_PLS_Live_Listings - b.T52W_PLS_Live_Listings)/b.T52W_PLS_Live_Listings T52W_PLS_Live_Listings_yoy,
(a.T52W_PLA_Live_listings - b.T52W_PLA_Live_listings)/b.T52W_PLA_Live_listings T52W_PLA_Live_listings_yoy,
(a.T52W_pls_sold_adrate - b.T52W_pls_sold_adrate)/b.T52W_pls_sold_adrate T52W_pls_sold_adrate_yoy,
(a.t52w_pla_ROAS - b.t52w_pla_ROAS)/b.t52w_pla_ROAS t52w_pla_ROAS_yoy,
(a.T52W_PLS_ROAS - b.T52W_PLS_ROAS)/b.T52W_PLS_ROAS T52W_PLS_ROAS_yoy,
(a.T52W_OVERALL_ROAS - b.T52W_OVERALL_ROAS)/b.T52W_OVERALL_ROAS T52W_OVERALL_ROAS_yoy,
(a.T1W_GMB - b.T1W_GMB)/b.T1W_GMB T1W_GMB_yoy,
(a.T1W_PURCHASES - b.T1W_PURCHASES)/b.T1W_PURCHASES T1W_PURCHASES_yoy,
(a.T52W_GMB - b.T52W_GMB)/b.T52W_GMB T52W_GMB_yoy,
(a.T52W_PURCHASES - b.T52W_PURCHASES)/b.T52W_PURCHASES T52W_PURCHASES_yoy,
(a.T1W_byr_cnt - b.T1W_byr_cnt)/b.T1W_byr_cnt T1W_byr_cnt_yoy,
(a.T1W_ACTV_BYR_CNT - b.T1W_ACTV_BYR_CNT)/b.T1W_ACTV_BYR_CNT T1W_ACTV_BYR_CNT_yoy,
(a.T1W_NORB_BYR_CNT - b.T1W_NORB_BYR_CNT)/b.T1W_NORB_BYR_CNT T1W_NORB_BYR_CNT_yoy,
(a.T52W_byr_cnt - b.T52W_byr_cnt)/b.T52W_byr_cnt T52W_byr_cnt_yoy,
(a.T1W_VIEW_COUNT - b.T1W_VIEW_COUNT)/b.T1W_VIEW_COUNT T1W_VIEW_COUNT_yoy,
(a.T52W_VIEW_COUNT - b.T52W_VIEW_COUNT)/b.T52W_VIEW_COUNT T52W_VIEW_COUNT_yoy,
(a.T1W_TOTAL_imps - b.T1W_TOTAL_imps)/b.T1W_TOTAL_imps T1W_TOTAL_imps_yoy,
(a.T1W_total_clicks - b.T1W_total_clicks)/b.T1W_total_clicks T1W_total_clicks_yoy,
(a.T1W_OVERALL_CTR - b.T1W_OVERALL_CTR)/b.T1W_OVERALL_CTR T1W_OVERALL_CTR_yoy,
(a.T1W_pl_clicks - b.T1W_pl_clicks)/b.T1W_pl_clicks T1W_pl_clicks_yoy,
(a.T1W_PL_CTR - b.T1W_PL_CTR)/b.T1W_PL_CTR T1W_PL_CTR_yoy,
(a.T1W_organic_impressions - b.T1W_organic_impressions)/b.T1W_organic_impressions T1W_organic_impressions_yoy,
(a.T1W_organic_clicks - b.T1W_organic_clicks)/b.T1W_organic_clicks T1W_organic_clicks_yoy,
(a.T1W_ORGANIC_CTR - b.T1W_ORGANIC_CTR)/b.T1W_ORGANIC_CTR T1W_ORGANIC_CTR_yoy,
(a.T1W_pla_imps - b.T1W_pla_imps)/b.T1W_pla_imps T1W_pla_imps_yoy,
(a.T1W_pla_clicks - b.T1W_pla_clicks)/b.T1W_pla_clicks T1W_pla_clicks_yoy,
(a.T1W_PLA_CTR - b.T1W_PLA_CTR)/b.T1W_PLA_CTR T1W_PLA_CTR_yoy,
(a.t52w_total_imprsns_curr - b.t52w_total_imprsns_curr)/b.t52w_total_imprsns_curr t52w_total_imprsns_curr_yoy,
(a.t52w_total_clicks_curr - b.t52w_total_clicks_curr)/b.t52w_total_clicks_curr t52w_total_clicks_curr_yoy,
(a.T52W_OVERALL_CTR - b.T52W_OVERALL_CTR)/b.T52W_OVERALL_CTR T52W_OVERALL_CTR_yoy,
(a.t52w_pl_imps_curr - b.t52w_pl_imps_curr)/b.t52w_pl_imps_curr t52w_pl_imps_curr_yoy,
(a.T52W_PL_CTR - b.T52W_PL_CTR)/b.T52W_PL_CTR T52W_PL_CTR_yoy,
(a.t52w_pla_imps_curr - b.t52w_pla_imps_curr)/b.t52w_pla_imps_curr t52w_pla_imps_curr_yoy,
(a.t52w_pla_clicks_curr - b.t52w_pla_clicks_curr)/b.t52w_pla_clicks_curr t52w_pla_clicks_curr_yoy,
(a.T52W_PLA_CTR - b.T52W_PLA_CTR)/b.T52W_PLA_CTR T52W_PLA_CTR_yoy,
(a.T1W_ads_fee_usd - b.T1W_ads_fee_usd)/b.T1W_ads_fee_usd T1W_ads_fee_usd_yoy,
(a.T1W_budget_amt_usd - b.T1W_budget_amt_usd)/b.T1W_budget_amt_usd T1W_budget_amt_usd_yoy,
(a.T1W_cmpgn_budget_usage - b.T1W_cmpgn_budget_usage)/b.T1W_cmpgn_budget_usage T1W_cmpgn_budget_usage_yoy,
(a.T52W_ads_fee_usd - b.T52W_ads_fee_usd)/b.T52W_ads_fee_usd T52W_ads_fee_usd_yoy,

(a.T52W_budget_amt_usd - b.T52W_budget_amt_usd)/b.T52W_budget_amt_usd T52W_budget_amt_usd_yoy,
(a.T52W_cmpgn_budget_usage - b.T52W_cmpgn_budget_usage)/b.T52W_cmpgn_budget_usage T52W_cmpgn_budget_usage_yoy,
(a.T1W_FIN3_BI - b.T1W_FIN3_BI)/b.T1W_FIN3_BI T1W_FIN3_BI_yoy,
(a.T1W_PROM_3D_BI - b.T1W_PROM_3D_BI)/b.T1W_PROM_3D_BI T1W_PROM_3D_BI_yoy,
(a.T1W_ACTUAL_3D_BI - b.T1W_ACTUAL_3D_BI)/b.T1W_ACTUAL_3D_BI T1W_ACTUAL_3D_BI_yoy,
(a.T1W_LATE_DELIVERY_BI - b.T1W_LATE_DELIVERY_BI)/b.T1W_LATE_DELIVERY_BI T1W_LATE_DELIVERY_BI_yoy,
(a.T1W_LDR - b.T1W_LDR)/b.T1W_LDR T1W_LDR_yoy,
(a.T1W_FREE_SHIPPING_TXNS - b.T1W_FREE_SHIPPING_TXNS)/b.T1W_FREE_SHIPPING_TXNS T1W_FREE_SHIPPING_TXNS_yoy,
(a.T1W_VALID_TRACKING_BI - b.T1W_VALID_TRACKING_BI)/b.T1W_VALID_TRACKING_BI T1W_VALID_TRACKING_BI_yoy,
(a.T1W_TRACKING_UPLOAD_BI - b.T1W_TRACKING_UPLOAD_BI)/b.T1W_TRACKING_UPLOAD_BI T1W_TRACKING_UPLOAD_BI_yoy,
(a.T1W_HT_0_1D_TXNS - b.T1W_HT_0_1D_TXNS)/b.T1W_HT_0_1D_TXNS T1W_HT_0_1D_TXNS_yoy,
(a.T1W_INR_14D_TXNS - b.T1W_INR_14D_TXNS)/b.T1W_INR_14D_TXNS T1W_INR_14D_TXNS_yoy,
(a.T1W_ESC_INR_14D_TXNS - b.T1W_ESC_INR_14D_TXNS)/b.T1W_ESC_INR_14D_TXNS T1W_ESC_INR_14D_TXNS_yoy,
(a.T52W_FIN3_BI - b.T52W_FIN3_BI)/b.T52W_FIN3_BI T52W_FIN3_BI_yoy,
(a.T52W_PROM_3D_BI - b.T52W_PROM_3D_BI)/b.T52W_PROM_3D_BI T52W_PROM_3D_BI_yoy,
(a.T52W_ACTUAL_3D_BI - b.T52W_ACTUAL_3D_BI)/b.T52W_ACTUAL_3D_BI T52W_ACTUAL_3D_BI_yoy,
(a.T52W_LATE_DELIVERY_BI - b.T52W_LATE_DELIVERY_BI)/b.T52W_LATE_DELIVERY_BI T52W_LATE_DELIVERY_BI_yoy,
(a.T52W_FREE_SHIPPING_TXNS - b.T52W_FREE_SHIPPING_TXNS)/b.T52W_FREE_SHIPPING_TXNS T52W_FREE_SHIPPING_TXNS_yoy,
(a.T52W_VALID_TRACKING_BI - b.T52W_VALID_TRACKING_BI)/b.T52W_VALID_TRACKING_BI T52W_VALID_TRACKING_BI_yoy,
(a.T52W_TRACKING_UPLOAD_BI - b.T52W_TRACKING_UPLOAD_BI)/b.T52W_TRACKING_UPLOAD_BI T52W_TRACKING_UPLOAD_BI_yoy,
(a.T52W_HT_0_1D_TXNS - b.T52W_HT_0_1D_TXNS)/b.T52W_HT_0_1D_TXNS T52W_HT_0_1D_TXNS_yoy,
(a.T52W_INR_14D_TXNS - b.T52W_INR_14D_TXNS)/b.T52W_INR_14D_TXNS T52W_INR_14D_TXNS_yoy,
(a.T52W_ESC_INR_14D_TXNS - b.T52W_ESC_INR_14D_TXNS)/b.T52W_ESC_INR_14D_TXNS T52W_ESC_INR_14D_TXNS_yoy,
(a.T1W_LL_1HD_pct - b.T1W_LL_1HD_pct)/b.T1W_LL_1HD_pct T1W_LL_1HD_pct_yoy,
(a.T1W_LL_next_day_pct - b.T1W_LL_next_day_pct)/b.T1W_LL_next_day_pct T1W_LL_next_day_pct_yoy,
(a.T1W_LL_tracked_services_pct - b.T1W_LL_tracked_services_pct)/b.T1W_LL_tracked_services_pct T1W_LL_tracked_services_pct_yoy,

(a.T1W_LL_0_3D_EDD_pct - b.T1W_LL_0_3D_EDD_pct)/b.T1W_LL_0_3D_EDD_pct T1W_LL_0_3D_EDD_pct_yoy,
(a.T52W_LL_with_Free_in_3_pct - b.T52W_LL_with_Free_in_3_pct)/b.T52W_LL_with_Free_in_3_pct T52W_LL_with_Free_in_3_pct_yoy,
(a.T52W_LL_1HD_pct - b.T52W_LL_1HD_pct)/b.T52W_LL_1HD_pct T52W_LL_1HD_pct_yoy,
(a.T52W_LL_next_day_pct - b.T52W_LL_next_day_pct)/b.T52W_LL_next_day_pct T52W_LL_next_day_pct_yoy,
(a.T52W_LL_tracked_services_pct - b.T52W_LL_tracked_services_pct)/b.T52W_LL_tracked_services_pct T52W_LL_tracked_services_pct_yoy,
(a.T52W_LL_0_3D_EDD_pct - b.T52W_LL_0_3D_EDD_pct)/b.T52W_LL_0_3D_EDD_pct T52W_LL_0_3D_EDD_pct_yoy
from P_nishant_local_T.final_metrics_2 a 
left join P_nishant_local_T.final_metrics_2 b 
on a.retail_week = b.retail_week
and a.retail_year = b.retail_year + 1 

-- AND SLR_ID = 121616051
-- coalesce(T1W_LL_0_3D_EDD_pct,0) as T1W_LL_0_3D_EDD_pct_curr ,
-- coalesce(lag(T1W_LL_0_3D_EDD_pct,1) over (partition by slr_id, retail_week order by retail_year asc ),0) as T1W_LL_0_3D_EDD_pct_prev,
-- (coalesce(T1W_LL_0_3D_EDD_pct,0)-coalesce(lag(T1W_LL_0_3D_EDD_pct,1)
-- over (partition by slr_id, retail_week
-- order by retail_year asc ),0))/coalesce(lag(T52W_LL_0_3D_EDD_pct,1) over (partition by slr_id, retail_week  order by retail_year asc ),0) as T1W_LL_0_3D_EDD_pct_yoy